<!doctype html>
<html>
	<head>
	<title>月亮流星效果</title>
	<meta charset="utf-8" />
	</head>

	<body>
		<canvas id="c"></canvas>
		<script>
function f(e){
  g=g?q.createElement("canvas"):q.body.children.c;
  g.width=e*100;
  g.height=c;
  a=g.getContext("2d");
  r.push(g);
}
function m(e,n,o){
  a.save();
  a.rotate(o);
  a.translate(0,-e);
  a.scale(n,n);
  o=l;
  l*=n;
  s();
  a.restore();
  l=o;
}
function s(){
  if(l>0.04){
    if(rand(1)<0.04){
      m(0,0.7,-0.15);
      m(0,0.7,0.15);
    }else {
      a.fillRect(0,0,9,9);
      m(4,1,rand(1)<0.5?0.08:-0.08);
    }
  }
}
function rand(e){
  return Math.random()*e;
}
function h(e){
  a.fillStyle=e;
}

var a,g,q=document,r=[],w="#FFF",c=400,p=i=0,l=1,b;
f(9);
j=a;
f(9);
k=a;
h(w);
f(9);
u=a;
h("rgba(0,0,0,.05)");
f(10);
for(h(w);i++<200;){
  a.fillRect(rand(1000),rand(c),rand(3),rand(3));
}
f(15);
b=a.createRadialGradient(c,120,20,c,120,900);
b.addColorStop(0.1,w);
b.addColorStop(0.11,"rgba(255,255,255,.3)");
b.addColorStop(1,"rgba(4,129,227,0)");
h(b);
a.fillRect(0,0,1500,c);
f(20);
h("#002b57");
for(a.translate(c,c);p++<4;a.translate(c,0)){
  s();
}
setInterval(function(){
  j.clearRect(0,0,900,c);
  j.drawImage(k.canvas,0,0);
  k.clearRect(0,0,900,c);
  k.drawImage(j.canvas,-1,1);
  u.fillRect(0,0,900,c);
  u.drawImage(k.canvas,0,0);
  if (rand(1)<0.03) {
		k.fillRect(rand(1000),0,rand(3),rand(3));
	}
  j.fillRect(0,0,900,c);
  for(i=1;++i<6;){
    j.drawImage(b=r[i], Math.abs(p%2-1)*-(b.width-900),0);
  }
  p+=0.001;
},10);
		</script>
	</body>
</html>